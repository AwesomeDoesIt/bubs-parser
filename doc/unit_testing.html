<html>
<head>
<title>Unit Testing and Profiling</title>
</head>

<body>
<h2>Unit Testing</h2>

<p>The shared code includes fairly extensive unit tests, implemented
using the <a href="http://www.junit.org/">JUnit</a> framework.</p> For examples, see any of the <i>TestXYZ</i> classes.

<h3>Motivation</h3>
<ul>
	<li>A good unit test suite allows common code ownership, since
	everyone has insight into the intended usage of the code and can verify
	that their own changes are not harmful.</li>
	<li>Writing tests prior to writing the code (<a
		href="http://en.wikipedia.org/wiki/Test-driven_development">Test-driven
	development</a>) often helps clarify your thinking about the problem and
	results in cleaner code (I generally find that it saves time as well,
	since debugging is largely automated).</li>
</ul>

<h3>Best Practices</h3>
<ul>
	<li>Run the full regression test suite prior to committing
	changes, to ensure that you haven't broken something others might
	depend on.</li>
	<li>It's also a good idea to write complete tests for your own
	code, since that allows others to modify, tune, and fix defects with
	confidence. If your code doesn't include tests, you bear at least part
	of the responsibility when someone else breaks it. ;-)</li>
</ul>

<h3>Test Data</h3>
Often, it's easiest and simplest just to include test data in the test
case itself, but some tests require more data than is practical to
include inline. External test data is stored in the
<i>unit-test-data</i>
directory. The entire Penn TreeBank is available in the
<i>corpora/wsj</i>
subdirectory thereof. Feel free to add any other test data you need;
please keep file size reasonable, and gzip anything over a few kilobytes
to preserve disk and repository space. The test hierarchy handles
reading gzipped data transparently, so compression saves everyone space
without costing any additional effort.

<h3>Performance Tests</h3>
<p>We're trying to write reasonably efficient implementations, and
it's often useful to profile our code, but profiling runs generally take
much longer than standard unit testing runs. And we don't want to slow
down the standard regression suite with several minutes of profiling
runs.</p
<p>Individual test methods or classes can be annotated with the <i>@PerformanceTest</i>
annotation. The <i>FilteredRunner</i> test runner will by default mark
any performance tests as ignored. You can run change the filter used by
specifying the <i>junit.filter.class</i> system property. For example, you
can run performance tests by including
<i>-Djunit.filter.class=edu.ohsu.cslu.tests.PerformanceTestFilter</i> on the
command-line (or in the <i>VM Arguments</i> field in your Eclipse runner
configuration).</p>

<h3>Naming Conventions</h3>
<ul>
	<li>Unit test classnames begin with <i>Test</i></li>
	<li>In general, tests for a specific class are named with <i>Test</i>
	prefixed to the class name. (e.g. <i>Foo</i> is tested by <i>TestFoo</i>)</li>
	<li>Test suites for a package begin with <i>All</i> and end with <i>Tests</i>.
	e.g., tests for the <i>edu.ohsu.cslu.common</i> package are in <i>AllCommonTests</i>.</li>
	<li>Test superclasses (classes containing test code shared by a
	number of individual test classes) are suffixed with <i>TestCase</i>.
	e.g., the various vector test classes (<i>TestIntVector</i>, <i>TestPackedIntVector</i>,
	etc.) extend <i>VectorTestCase</i>.</li>
	<li>Profiling / performance test classes are prefixed <i>Profile</i>.
	e.g., all match algorithms are profiled by <i>ProfileMatchers</i>.
</ul>


<font color="#777777"> Author: Aaron Dunlop<br />
Last Changed By: $Author: dunlopa $<br />
Revision: $Rev: 287 $<br />
Last Changed: $LastChangedDate: 2009-02-18 14:51:30 -0800 (Wed, 18 Feb
2009) $<br />
</font>
</body>
</html>